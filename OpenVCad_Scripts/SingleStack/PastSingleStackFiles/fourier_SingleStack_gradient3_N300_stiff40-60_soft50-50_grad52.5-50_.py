# ── SinglStack.py ────────────────────────────────────────────────────────────────
import pyvcad as pv

#----------------------
#------- SETUP --------
#----------------------

#-- STL File Directory --
STL_Location = "MAC_LAB/STL Files/VariableSingleStack"

#-- Material definitions --
materials = pv.MaterialDefs("configs/default.json")
red = materials.id("red")            # Agilus
blue = materials.id("blue")          # Vero
liquid_mat = materials.id("liquid")  # Liquid matieral
green = materials.id("green")        # Support
yellow = materials.id("yellow")      # Air

#-- Dimensions of part --
mainHeight = 3.5   # Dr. Mac's: 3.5[mm]
mainD = 25         # Dr. Mac's: 25[mm]
capHeight = 1      #[mm]

#-- Stack Settings --
numStacks = 3
includeBaffles = True
fluidPercent = 0.725

#-- placing stuff --
x = 3.862152
y = 3.862152
z = 0

#-- Defining Root Node --
root = pv.Union()

#-----------------------------------------------------
#-- Importing meshes ---------------------------------
#-----------------------------------------------------

#-- Outter Bellow --
bellows1 = pv.Mesh(
    STL_Location + "/variableNumberBellowsStack_ASSEMBLY - Variable_Bellow-1.STL", red)
bellows1 = pv.Translate(-x-mainD/2, -y-mainD/2,0 , bellows1)

# === MATERIAL GRADING ===
# Gradient Type: gradient3
# Design Type: Single stack
# Stiff Section Settings: 60% Vero, 40% Agilus
# Soft  Section Settings: 50% Vero, 50% Agilus
# Gradient Start / End:   52.5% → 50%
# Gradient4 Vero/Agilus:  50% / 50%
#
# N (number of Fourier modes) = 300,  L = 15
#

# Use the computed Fourier‐series strings in the call below:
bellows_fgrade = pv.FGrade(
    [
          "0.4779215495 -0.0083934229 * cos(1*pi ((x^2 + y^2)^0.5)/15) +0.0661091802 * cos(2*pi ((x^2 + y^2)^0.5)/15) +0.0102904406 * cos(3*pi ((x^2 + y^2)^0.5)/15) -0.0194219040 * cos(4*pi ((x^2 + y^2)^0.5)/15) -0.0001373491 * cos(5*pi ((x^2 + y^2)^0.5)/15) -0.0046272326 * cos(6*pi ((x^2 + y^2)^0.5)/15) -0.0040517097 * cos(7*pi ((x^2 + y^2)^0.5)/15) +0.0064672239 * cos(8*pi ((x^2 + y^2)^0.5)/15) +0.0021380884 * cos(9*pi ((x^2 + y^2)^0.5)/15) +0.0002190957 * cos(10*pi ((x^2 + y^2)^0.5)/15) +0.0023155187 * cos(11*pi ((x^2 + y^2)^0.5)/15) -0.0027837106 * cos(12*pi ((x^2 + y^2)^0.5)/15) -0.0030372137 * cos(13*pi ((x^2 + y^2)^0.5)/15) +0.0007554398 * cos(14*pi ((x^2 + y^2)^0.5)/15) -0.0006752103 * cos(15*pi ((x^2 + y^2)^0.5)/15) +0.0008396104 * cos(16*pi ((x^2 + y^2)^0.5)/15) +0.0029698922 * cos(17*pi ((x^2 + y^2)^0.5)/15) -0.0004358168 * cos(18*pi ((x^2 + y^2)^0.5)/15) -0.0007199433 * cos(19*pi ((x^2 + y^2)^0.5)/15) -0.0000108156 * cos(20*pi ((x^2 + y^2)^0.5)/15) -0.0021366349 * cos(21*pi ((x^2 + y^2)^0.5)/15) -0.0002873516 * cos(22*pi ((x^2 + y^2)^0.5)/15) +0.0014995942 * cos(23*pi ((x^2 + y^2)^0.5)/15) +0.0000640369 * cos(24*pi ((x^2 + y^2)^0.5)/15) +0.0009949384 * cos(25*pi ((x^2 + y^2)^0.5)/15) +0.0007841864 * cos(26*pi ((x^2 + y^2)^0.5)/15) -0.0015418433 * cos(27*pi ((x^2 + y^2)^0.5)/15) -0.0006010540 * cos(28*pi ((x^2 + y^2)^0.5)/15) -0.0000512287 * cos(29*pi ((x^2 + y^2)^0.5)/15) -0.0007491762 * cos(30*pi ((x^2 + y^2)^0.5)/15) +0.0010512018 * cos(31*pi ((x^2 + y^2)^0.5)/15) +0.0011383558 * cos(32*pi ((x^2 + y^2)^0.5)/15) -0.0003771436 * cos(33*pi ((x^2 + y^2)^0.5)/15) +0.0002427595 * cos(34*pi ((x^2 + y^2)^0.5)/15) -0.0004272339 * cos(35*pi ((x^2 + y^2)^0.5)/15) -0.0013148466 * cos(36*pi ((x^2 + y^2)^0.5)/15) +0.0002832567 * cos(37*pi ((x^2 + y^2)^0.5)/15) +0.0004201180 * cos(38*pi ((x^2 + y^2)^0.5)/15) +0.0000404937 * cos(39*pi ((x^2 + y^2)^0.5)/15) +0.0010384179 * cos(40*pi ((x^2 + y^2)^0.5)/15) +0.0000790315 * cos(41*pi ((x^2 + y^2)^0.5)/15) -0.0008844025 * cos(42*pi ((x^2 + y^2)^0.5)/15) -0.0000495661 * cos(43*pi ((x^2 + y^2)^0.5)/15) -0.0004837205 * cos(44*pi ((x^2 + y^2)^0.5)/15) -0.0003718810 * cos(45*pi ((x^2 + y^2)^0.5)/15) +0.0009549904 * cos(46*pi ((x^2 + y^2)^0.5)/15) +0.0003539250 * cos(47*pi ((x^2 + y^2)^0.5)/15) -0.0000468457 * cos(48*pi ((x^2 + y^2)^0.5)/15) +0.0003692498 * cos(49*pi ((x^2 + y^2)^0.5)/15) -0.0006799859 * cos(50*pi ((x^2 + y^2)^0.5)/15) -0.0006929975 * cos(51*pi ((x^2 + y^2)^0.5)/15) +0.0003104088 * cos(52*pi ((x^2 + y^2)^0.5)/15) -0.0000640282 * cos(53*pi ((x^2 + y^2)^0.5)/15) +0.0002875249 * cos(54*pi ((x^2 + y^2)^0.5)/15) +0.0008199055 * cos(55*pi ((x^2 + y^2)^0.5)/15) -0.0002517476 * cos(56*pi ((x^2 + y^2)^0.5)/15) -0.0003613104 * cos(57*pi ((x^2 + y^2)^0.5)/15) -0.0000299513 * cos(58*pi ((x^2 + y^2)^0.5)/15) -0.0006440204 * cos(59*pi ((x^2 + y^2)^0.5)/15) +0.0000082089 * cos(60*pi ((x^2 + y^2)^0.5)/15) +0.0006675185 * cos(61*pi ((x^2 + y^2)^0.5)/15) +0.0000347995 * cos(62*pi ((x^2 + y^2)^0.5)/15) +0.0002651447 * cos(63*pi ((x^2 + y^2)^0.5)/15) +0.0001967995 * cos(64*pi ((x^2 + y^2)^0.5)/15) -0.0007071387 * cos(65*pi ((x^2 + y^2)^0.5)/15) -0.0002471570 * cos(66*pi ((x^2 + y^2)^0.5)/15) +0.0001078361 * cos(67*pi ((x^2 + y^2)^0.5)/15) -0.0001976491 * cos(68*pi ((x^2 + y^2)^0.5)/15) +0.0005014501 * cos(69*pi ((x^2 + y^2)^0.5)/15) +0.0004862924 * cos(70*pi ((x^2 + y^2)^0.5)/15) -0.0002934317 * cos(71*pi ((x^2 + y^2)^0.5)/15) -0.0000204345 * cos(72*pi ((x^2 + y^2)^0.5)/15) -0.0002088810 * cos(73*pi ((x^2 + y^2)^0.5)/15) -0.0005705839 * cos(74*pi ((x^2 + y^2)^0.5)/15) +0.0002426744 * cos(75*pi ((x^2 + y^2)^0.5)/15) +0.0003286942 * cos(76*pi ((x^2 + y^2)^0.5)/15) +0.0000151019 * cos(77*pi ((x^2 + y^2)^0.5)/15) +0.0004293679 * cos(78*pi ((x^2 + y^2)^0.5)/15) -0.0000535206 * cos(79*pi ((x^2 + y^2)^0.5)/15) -0.0005480585 * cos(80*pi ((x^2 + y^2)^0.5)/15) -0.0000182602 * cos(81*pi ((x^2 + y^2)^0.5)/15) -0.0001361256 * cos(82*pi ((x^2 + y^2)^0.5)/15) -0.0001050770 * cos(83*pi ((x^2 + y^2)^0.5)/15) +0.0005638865 * cos(84*pi ((x^2 + y^2)^0.5)/15) +0.0001787583 * cos(85*pi ((x^2 + y^2)^0.5)/15) -0.0001493180 * cos(86*pi ((x^2 + y^2)^0.5)/15) +0.0001048364 * cos(87*pi ((x^2 + y^2)^0.5)/15) -0.0003907505 * cos(88*pi ((x^2 + y^2)^0.5)/15) -0.0003579144 * cos(89*pi ((x^2 + y^2)^0.5)/15) +0.0002860333 * cos(90*pi ((x^2 + y^2)^0.5)/15) +0.0000657130 * cos(91*pi ((x^2 + y^2)^0.5)/15) +0.0001522408 * cos(92*pi ((x^2 + y^2)^0.5)/15) +0.0004139841 * cos(93*pi ((x^2 + y^2)^0.5)/15) -0.0002362457 * cos(94*pi ((x^2 + y^2)^0.5)/15) -0.0003040746 * cos(95*pi ((x^2 + y^2)^0.5)/15) +0.0000045290 * cos(96*pi ((x^2 + y^2)^0.5)/15) -0.0002917901 * cos(97*pi ((x^2 + y^2)^0.5)/15) +0.0000788045 * cos(98*pi ((x^2 + y^2)^0.5)/15) +0.0004671388 * cos(99*pi ((x^2 + y^2)^0.5)/15) -0.0000016866 * cos(100*pi ((x^2 + y^2)^0.5)/15) +0.0000512961 * cos(101*pi ((x^2 + y^2)^0.5)/15) +0.0000505378 * cos(102*pi ((x^2 + y^2)^0.5)/15) -0.0004639663 * cos(103*pi ((x^2 + y^2)^0.5)/15) -0.0001272760 * cos(104*pi ((x^2 + y^2)^0.5)/15) +0.0001777319 * cos(105*pi ((x^2 + y^2)^0.5)/15) -0.0000492601 * cos(106*pi ((x^2 + y^2)^0.5)/15) +0.0003089496 * cos(107*pi ((x^2 + y^2)^0.5)/15) +0.0002682165 * cos(108*pi ((x^2 + y^2)^0.5)/15) -0.0002812331 * cos(109*pi ((x^2 + y^2)^0.5)/15) -0.0000896602 * cos(110*pi ((x^2 + y^2)^0.5)/15) -0.0001053005 * cos(111*pi ((x^2 + y^2)^0.5)/15) -0.0003052815 * cos(112*pi ((x^2 + y^2)^0.5)/15) +0.0002303518 * cos(113*pi ((x^2 + y^2)^0.5)/15) +0.0002800644 * cos(114*pi ((x^2 + y^2)^0.5)/15) -0.0000257274 * cos(115*pi ((x^2 + y^2)^0.5)/15) +0.0001952265 * cos(116*pi ((x^2 + y^2)^0.5)/15) -0.0000926724 * cos(117*pi ((x^2 + y^2)^0.5)/15) -0.0004034548 * cos(118*pi ((x^2 + y^2)^0.5)/15) +0.0000217780 * cos(119*pi ((x^2 + y^2)^0.5)/15) +0.0000091617 * cos(120*pi ((x^2 + y^2)^0.5)/15) -0.0000178157 * cos(121*pi ((x^2 + y^2)^0.5)/15) +0.0003862133 * cos(122*pi ((x^2 + y^2)^0.5)/15) +0.0000861374 * cos(123*pi ((x^2 + y^2)^0.5)/15) -0.0001978360 * cos(124*pi ((x^2 + y^2)^0.5)/15) +0.0000164900 * cos(125*pi ((x^2 + y^2)^0.5)/15) -0.0002435923 * cos(126*pi ((x^2 + y^2)^0.5)/15) -0.0002004370 * cos(127*pi ((x^2 + y^2)^0.5)/15) +0.0002759898 * cos(128*pi ((x^2 + y^2)^0.5)/15) +0.0000997874 * cos(129*pi ((x^2 + y^2)^0.5)/15) +0.0000649028 * cos(130*pi ((x^2 + y^2)^0.5)/15) +0.0002241546 * cos(131*pi ((x^2 + y^2)^0.5)/15) -0.0002224294 * cos(132*pi ((x^2 + y^2)^0.5)/15) -0.0002556206 * cos(133*pi ((x^2 + y^2)^0.5)/15) +0.0000471151 * cos(134*pi ((x^2 + y^2)^0.5)/15) -0.0001235473 * cos(135*pi ((x^2 + y^2)^0.5)/15) +0.0000978288 * cos(136*pi ((x^2 + y^2)^0.5)/15) +0.0003498714 * cos(137*pi ((x^2 + y^2)^0.5)/15) -0.0000416662 * cos(138*pi ((x^2 + y^2)^0.5)/15) -0.0000532274 * cos(139*pi ((x^2 + y^2)^0.5)/15) -0.0003218771 * cos(141*pi ((x^2 + y^2)^0.5)/15) -0.0000516360 * cos(142*pi ((x^2 + y^2)^0.5)/15) +0.0002106403 * cos(143*pi ((x^2 + y^2)^0.5)/15) +0.0000019348 * cos(144*pi ((x^2 + y^2)^0.5)/15) +0.0001882758 * cos(145*pi ((x^2 + y^2)^0.5)/15) +0.0001471365 * cos(146*pi ((x^2 + y^2)^0.5)/15) -0.0002686063 * cos(147*pi ((x^2 + y^2)^0.5)/15) -0.0001011041 * cos(148*pi ((x^2 + y^2)^0.5)/15) -0.0000286562 * cos(149*pi ((x^2 + y^2)^0.5)/15) -0.0001618797 * cos(150*pi ((x^2 + y^2)^0.5)/15) +0.0002121191 * cos(151*pi ((x^2 + y^2)^0.5)/15) +0.0002304757 * cos(152*pi ((x^2 + y^2)^0.5)/15) -0.0000680609 * cos(153*pi ((x^2 + y^2)^0.5)/15) +0.0000694381 * cos(154*pi ((x^2 + y^2)^0.5)/15) -0.0000968474 * cos(155*pi ((x^2 + y^2)^0.5)/15) -0.0003022207 * cos(156*pi ((x^2 + y^2)^0.5)/15) +0.0000602696 * cos(157*pi ((x^2 + y^2)^0.5)/15) +0.0000852624 * cos(158*pi ((x^2 + y^2)^0.5)/15) +0.0000094535 * cos(159*pi ((x^2 + y^2)^0.5)/15) +0.0002660401 * cos(160*pi ((x^2 + y^2)^0.5)/15) +0.0000229197 * cos(161*pi ((x^2 + y^2)^0.5)/15) -0.0002176099 * cos(162*pi ((x^2 + y^2)^0.5)/15) -0.0000102809 * cos(163*pi ((x^2 + y^2)^0.5)/15) -0.0001400070 * cos(164*pi ((x^2 + y^2)^0.5)/15) -0.0001047520 * cos(165*pi ((x^2 + y^2)^0.5)/15) +0.0002589248 * cos(166*pi ((x^2 + y^2)^0.5)/15) +0.0000959118 * cos(167*pi ((x^2 + y^2)^0.5)/15) -0.0000037938 * cos(168*pi ((x^2 + y^2)^0.5)/15) +0.0001132747 * cos(169*pi ((x^2 + y^2)^0.5)/15) -0.0001992868 * cos(170*pi ((x^2 + y^2)^0.5)/15) -0.0002045709 * cos(171*pi ((x^2 + y^2)^0.5)/15) +0.0000874653 * cos(172*pi ((x^2 + y^2)^0.5)/15) -0.0000281296 * cos(173*pi ((x^2 + y^2)^0.5)/15) +0.0000907685 * cos(174*pi ((x^2 + y^2)^0.5)/15) +0.0002588705 * cos(175*pi ((x^2 + y^2)^0.5)/15) -0.0000768935 * cos(176*pi ((x^2 + y^2)^0.5)/15) -0.0001080570 * cos(177*pi ((x^2 + y^2)^0.5)/15) -0.0000108594 * cos(178*pi ((x^2 + y^2)^0.5)/15) -0.0002167408 * cos(179*pi ((x^2 + y^2)^0.5)/15) +0.0002193720 * cos(181*pi ((x^2 + y^2)^0.5)/15) +0.0000113781 * cos(182*pi ((x^2 + y^2)^0.5)/15) +0.0000974728 * cos(183*pi ((x^2 + y^2)^0.5)/15) +0.0000708472 * cos(184*pi ((x^2 + y^2)^0.5)/15) -0.0002464995 * cos(185*pi ((x^2 + y^2)^0.5)/15) -0.0000863292 * cos(186*pi ((x^2 + y^2)^0.5)/15) +0.0000327791 * cos(187*pi ((x^2 + y^2)^0.5)/15) -0.0000753335 * cos(188*pi ((x^2 + y^2)^0.5)/15) +0.0001838632 * cos(189*pi ((x^2 + y^2)^0.5)/15) +0.0001785240 * cos(190*pi ((x^2 + y^2)^0.5)/15) -0.0001049814 * cos(191*pi ((x^2 + y^2)^0.5)/15) -0.0000028872 * cos(192*pi ((x^2 + y^2)^0.5)/15) -0.0000807121 * cos(193*pi ((x^2 + y^2)^0.5)/15) -0.0002190238 * cos(194*pi ((x^2 + y^2)^0.5)/15) +0.0000911722 * cos(195*pi ((x^2 + y^2)^0.5)/15) +0.0001230904 * cos(196*pi ((x^2 + y^2)^0.5)/15) +0.0000069827 * cos(197*pi ((x^2 + y^2)^0.5)/15) +0.0001726112 * cos(198*pi ((x^2 + y^2)^0.5)/15) -0.0000201092 * cos(199*pi ((x^2 + y^2)^0.5)/15) -0.0002165177 * cos(200*pi ((x^2 + y^2)^0.5)/15) -0.0000073771 * cos(201*pi ((x^2 + y^2)^0.5)/15) -0.0000597288 * cos(202*pi ((x^2 + y^2)^0.5)/15) -0.0000442821 * cos(203*pi ((x^2 + y^2)^0.5)/15) +0.0002315725 * cos(204*pi ((x^2 + y^2)^0.5)/15) +0.0000737116 * cos(205*pi ((x^2 + y^2)^0.5)/15) -0.0000583295 * cos(206*pi ((x^2 + y^2)^0.5)/15) +0.0000462483 * cos(207*pi ((x^2 + y^2)^0.5)/15) -0.0001662799 * cos(208*pi ((x^2 + y^2)^0.5)/15) -0.0001526204 * cos(209*pi ((x^2 + y^2)^0.5)/15) +0.0001199887 * cos(210*pi ((x^2 + y^2)^0.5)/15) +0.0000255062 * cos(211*pi ((x^2 + y^2)^0.5)/15) +0.0000675704 * cos(212*pi ((x^2 + y^2)^0.5)/15) +0.0001822471 * cos(213*pi ((x^2 + y^2)^0.5)/15) -0.0001025705 * cos(214*pi ((x^2 + y^2)^0.5)/15) -0.0001317582 * cos(215*pi ((x^2 + y^2)^0.5)/15) -0.0001331087 * cos(217*pi ((x^2 + y^2)^0.5)/15) +0.0000348622 * cos(218*pi ((x^2 + y^2)^0.5)/15) +0.0002097141 * cos(219*pi ((x^2 + y^2)^0.5)/15) +0.0000265600 * cos(221*pi ((x^2 + y^2)^0.5)/15) +0.0000240169 * cos(222*pi ((x^2 + y^2)^0.5)/15) -0.0002143308 * cos(223*pi ((x^2 + y^2)^0.5)/15) -0.0000591909 * cos(224*pi ((x^2 + y^2)^0.5)/15) +0.0000802745 * cos(225*pi ((x^2 + y^2)^0.5)/15) -0.0000245300 * cos(226*pi ((x^2 + y^2)^0.5)/15) +0.0001467711 * cos(227*pi ((x^2 + y^2)^0.5)/15) +0.0001274664 * cos(228*pi ((x^2 + y^2)^0.5)/15) -0.0001321751 * cos(229*pi ((x^2 + y^2)^0.5)/15) -0.0000410904 * cos(230*pi ((x^2 + y^2)^0.5)/15) -0.0000520487 * cos(231*pi ((x^2 + y^2)^0.5)/15) -0.0001485969 * cos(232*pi ((x^2 + y^2)^0.5)/15) +0.0001109564 * cos(233*pi ((x^2 + y^2)^0.5)/15) +0.0001349468 * cos(234*pi ((x^2 + y^2)^0.5)/15) -0.0000115306 * cos(235*pi ((x^2 + y^2)^0.5)/15) +0.0000979633 * cos(236*pi ((x^2 + y^2)^0.5)/15) -0.0000454274 * cos(237*pi ((x^2 + y^2)^0.5)/15) -0.0001994163 * cos(238*pi ((x^2 + y^2)^0.5)/15) +0.0000103747 * cos(239*pi ((x^2 + y^2)^0.5)/15) +0.0000022904 * cos(240*pi ((x^2 + y^2)^0.5)/15) -0.0000093845 * cos(241*pi ((x^2 + y^2)^0.5)/15) +0.0001951116 * cos(242*pi ((x^2 + y^2)^0.5)/15) +0.0000437986 * cos(243*pi ((x^2 + y^2)^0.5)/15) -0.0000986176 * cos(244*pi ((x^2 + y^2)^0.5)/15) +0.0000092343 * cos(245*pi ((x^2 + y^2)^0.5)/15) -0.0001258659 * cos(246*pi ((x^2 + y^2)^0.5)/15) -0.0001035169 * cos(247*pi ((x^2 + y^2)^0.5)/15) +0.0001413062 * cos(248*pi ((x^2 + y^2)^0.5)/15) +0.0000506517 * cos(249*pi ((x^2 + y^2)^0.5)/15) +0.0000349731 * cos(250*pi ((x^2 + y^2)^0.5)/15) +0.0001180478 * cos(251*pi ((x^2 + y^2)^0.5)/15) -0.0001161148 * cos(252*pi ((x^2 + y^2)^0.5)/15) -0.0001335414 * cos(253*pi ((x^2 + y^2)^0.5)/15) +0.0000239544 * cos(254*pi ((x^2 + y^2)^0.5)/15) -0.0000669925 * cos(255*pi ((x^2 + y^2)^0.5)/15) +0.0000519218 * cos(256*pi ((x^2 + y^2)^0.5)/15) +0.0001862869 * cos(257*pi ((x^2 + y^2)^0.5)/15) -0.0000218075 * cos(258*pi ((x^2 + y^2)^0.5)/15) -0.0000268725 * cos(259*pi ((x^2 + y^2)^0.5)/15) -0.0001744012 * cos(261*pi ((x^2 + y^2)^0.5)/15) -0.0000282761 * cos(262*pi ((x^2 + y^2)^0.5)/15) +0.0001132092 * cos(263*pi ((x^2 + y^2)^0.5)/15) +0.0001040330 * cos(265*pi ((x^2 + y^2)^0.5)/15) +0.0000812174 * cos(266*pi ((x^2 + y^2)^0.5)/15) -0.0001471906 * cos(267*pi ((x^2 + y^2)^0.5)/15) -0.0000551847 * cos(268*pi ((x^2 + y^2)^0.5)/15) -0.0000169612 * cos(269*pi ((x^2 + y^2)^0.5)/15) -0.0000907822 * cos(270*pi ((x^2 + y^2)^0.5)/15) +0.0001180412 * cos(271*pi ((x^2 + y^2)^0.5)/15) +0.0001283336 * cos(272*pi ((x^2 + y^2)^0.5)/15) -0.0000373368 * cos(273*pi ((x^2 + y^2)^0.5)/15) +0.0000402108 * cos(274*pi ((x^2 + y^2)^0.5)/15) -0.0000546606 * cos(275*pi ((x^2 + y^2)^0.5)/15) -0.0001708595 * cos(276*pi ((x^2 + y^2)^0.5)/15) +0.0000337231 * cos(277*pi ((x^2 + y^2)^0.5)/15) +0.0000472331 * cos(278*pi ((x^2 + y^2)^0.5)/15) +0.0000053642 * cos(279*pi ((x^2 + y^2)^0.5)/15) +0.0001526208 * cos(280*pi ((x^2 + y^2)^0.5)/15) +0.0000133855 * cos(281*pi ((x^2 + y^2)^0.5)/15) -0.0001240854 * cos(282*pi ((x^2 + y^2)^0.5)/15) -0.0000056759 * cos(283*pi ((x^2 + y^2)^0.5)/15) -0.0000817837 * cos(284*pi ((x^2 + y^2)^0.5)/15) -0.0000610128 * cos(285*pi ((x^2 + y^2)^0.5)/15) +0.0001498502 * cos(286*pi ((x^2 + y^2)^0.5)/15) +0.0000554629 * cos(287*pi ((x^2 + y^2)^0.5)/15) -0.0000012892 * cos(288*pi ((x^2 + y^2)^0.5)/15) +0.0000669066 * cos(289*pi ((x^2 + y^2)^0.5)/15) -0.0001168187 * cos(290*pi ((x^2 + y^2)^0.5)/15) -0.0001200237 * cos(291*pi ((x^2 + y^2)^0.5)/15) +0.0000508653 * cos(292*pi ((x^2 + y^2)^0.5)/15) -0.0000175233 * cos(293*pi ((x^2 + y^2)^0.5)/15) +0.0000539010 * cos(294*pi ((x^2 + y^2)^0.5)/15) +0.0001537495 * cos(295*pi ((x^2 + y^2)^0.5)/15) -0.0000453675 * cos(296*pi ((x^2 + y^2)^0.5)/15) -0.0000634843 * cos(297*pi ((x^2 + y^2)^0.5)/15) -0.0000065938 * cos(298*pi ((x^2 + y^2)^0.5)/15) -0.0001303344 * cos(299*pi ((x^2 + y^2)^0.5)/15)",
          "0.5220784505 +0.0083934229 * cos(1*pi ((x^2 + y^2)^0.5)/15) -0.0661091802 * cos(2*pi ((x^2 + y^2)^0.5)/15) -0.0102904406 * cos(3*pi ((x^2 + y^2)^0.5)/15) +0.0194219040 * cos(4*pi ((x^2 + y^2)^0.5)/15) +0.0001373491 * cos(5*pi ((x^2 + y^2)^0.5)/15) +0.0046272326 * cos(6*pi ((x^2 + y^2)^0.5)/15) +0.0040517097 * cos(7*pi ((x^2 + y^2)^0.5)/15) -0.0064672239 * cos(8*pi ((x^2 + y^2)^0.5)/15) -0.0021380884 * cos(9*pi ((x^2 + y^2)^0.5)/15) -0.0002190957 * cos(10*pi ((x^2 + y^2)^0.5)/15) -0.0023155187 * cos(11*pi ((x^2 + y^2)^0.5)/15) +0.0027837106 * cos(12*pi ((x^2 + y^2)^0.5)/15) +0.0030372137 * cos(13*pi ((x^2 + y^2)^0.5)/15) -0.0007554398 * cos(14*pi ((x^2 + y^2)^0.5)/15) +0.0006752103 * cos(15*pi ((x^2 + y^2)^0.5)/15) -0.0008396104 * cos(16*pi ((x^2 + y^2)^0.5)/15) -0.0029698922 * cos(17*pi ((x^2 + y^2)^0.5)/15) +0.0004358168 * cos(18*pi ((x^2 + y^2)^0.5)/15) +0.0007199433 * cos(19*pi ((x^2 + y^2)^0.5)/15) +0.0000108156 * cos(20*pi ((x^2 + y^2)^0.5)/15) +0.0021366349 * cos(21*pi ((x^2 + y^2)^0.5)/15) +0.0002873516 * cos(22*pi ((x^2 + y^2)^0.5)/15) -0.0014995942 * cos(23*pi ((x^2 + y^2)^0.5)/15) -0.0000640369 * cos(24*pi ((x^2 + y^2)^0.5)/15) -0.0009949384 * cos(25*pi ((x^2 + y^2)^0.5)/15) -0.0007841864 * cos(26*pi ((x^2 + y^2)^0.5)/15) +0.0015418433 * cos(27*pi ((x^2 + y^2)^0.5)/15) +0.0006010540 * cos(28*pi ((x^2 + y^2)^0.5)/15) +0.0000512287 * cos(29*pi ((x^2 + y^2)^0.5)/15) +0.0007491762 * cos(30*pi ((x^2 + y^2)^0.5)/15) -0.0010512018 * cos(31*pi ((x^2 + y^2)^0.5)/15) -0.0011383558 * cos(32*pi ((x^2 + y^2)^0.5)/15) +0.0003771436 * cos(33*pi ((x^2 + y^2)^0.5)/15) -0.0002427595 * cos(34*pi ((x^2 + y^2)^0.5)/15) +0.0004272339 * cos(35*pi ((x^2 + y^2)^0.5)/15) +0.0013148466 * cos(36*pi ((x^2 + y^2)^0.5)/15) -0.0002832567 * cos(37*pi ((x^2 + y^2)^0.5)/15) -0.0004201180 * cos(38*pi ((x^2 + y^2)^0.5)/15) -0.0000404937 * cos(39*pi ((x^2 + y^2)^0.5)/15) -0.0010384179 * cos(40*pi ((x^2 + y^2)^0.5)/15) -0.0000790315 * cos(41*pi ((x^2 + y^2)^0.5)/15) +0.0008844025 * cos(42*pi ((x^2 + y^2)^0.5)/15) +0.0000495661 * cos(43*pi ((x^2 + y^2)^0.5)/15) +0.0004837205 * cos(44*pi ((x^2 + y^2)^0.5)/15) +0.0003718810 * cos(45*pi ((x^2 + y^2)^0.5)/15) -0.0009549904 * cos(46*pi ((x^2 + y^2)^0.5)/15) -0.0003539250 * cos(47*pi ((x^2 + y^2)^0.5)/15) +0.0000468457 * cos(48*pi ((x^2 + y^2)^0.5)/15) -0.0003692498 * cos(49*pi ((x^2 + y^2)^0.5)/15) +0.0006799859 * cos(50*pi ((x^2 + y^2)^0.5)/15) +0.0006929975 * cos(51*pi ((x^2 + y^2)^0.5)/15) -0.0003104088 * cos(52*pi ((x^2 + y^2)^0.5)/15) +0.0000640282 * cos(53*pi ((x^2 + y^2)^0.5)/15) -0.0002875249 * cos(54*pi ((x^2 + y^2)^0.5)/15) -0.0008199055 * cos(55*pi ((x^2 + y^2)^0.5)/15) +0.0002517476 * cos(56*pi ((x^2 + y^2)^0.5)/15) +0.0003613104 * cos(57*pi ((x^2 + y^2)^0.5)/15) +0.0000299513 * cos(58*pi ((x^2 + y^2)^0.5)/15) +0.0006440204 * cos(59*pi ((x^2 + y^2)^0.5)/15) -0.0000082089 * cos(60*pi ((x^2 + y^2)^0.5)/15) -0.0006675185 * cos(61*pi ((x^2 + y^2)^0.5)/15) -0.0000347995 * cos(62*pi ((x^2 + y^2)^0.5)/15) -0.0002651447 * cos(63*pi ((x^2 + y^2)^0.5)/15) -0.0001967995 * cos(64*pi ((x^2 + y^2)^0.5)/15) +0.0007071387 * cos(65*pi ((x^2 + y^2)^0.5)/15) +0.0002471570 * cos(66*pi ((x^2 + y^2)^0.5)/15) -0.0001078361 * cos(67*pi ((x^2 + y^2)^0.5)/15) +0.0001976491 * cos(68*pi ((x^2 + y^2)^0.5)/15) -0.0005014501 * cos(69*pi ((x^2 + y^2)^0.5)/15) -0.0004862924 * cos(70*pi ((x^2 + y^2)^0.5)/15) +0.0002934317 * cos(71*pi ((x^2 + y^2)^0.5)/15) +0.0000204345 * cos(72*pi ((x^2 + y^2)^0.5)/15) +0.0002088810 * cos(73*pi ((x^2 + y^2)^0.5)/15) +0.0005705839 * cos(74*pi ((x^2 + y^2)^0.5)/15) -0.0002426744 * cos(75*pi ((x^2 + y^2)^0.5)/15) -0.0003286942 * cos(76*pi ((x^2 + y^2)^0.5)/15) -0.0000151019 * cos(77*pi ((x^2 + y^2)^0.5)/15) -0.0004293679 * cos(78*pi ((x^2 + y^2)^0.5)/15) +0.0000535206 * cos(79*pi ((x^2 + y^2)^0.5)/15) +0.0005480585 * cos(80*pi ((x^2 + y^2)^0.5)/15) +0.0000182602 * cos(81*pi ((x^2 + y^2)^0.5)/15) +0.0001361256 * cos(82*pi ((x^2 + y^2)^0.5)/15) +0.0001050770 * cos(83*pi ((x^2 + y^2)^0.5)/15) -0.0005638865 * cos(84*pi ((x^2 + y^2)^0.5)/15) -0.0001787583 * cos(85*pi ((x^2 + y^2)^0.5)/15) +0.0001493180 * cos(86*pi ((x^2 + y^2)^0.5)/15) -0.0001048364 * cos(87*pi ((x^2 + y^2)^0.5)/15) +0.0003907505 * cos(88*pi ((x^2 + y^2)^0.5)/15) +0.0003579144 * cos(89*pi ((x^2 + y^2)^0.5)/15) -0.0002860333 * cos(90*pi ((x^2 + y^2)^0.5)/15) -0.0000657130 * cos(91*pi ((x^2 + y^2)^0.5)/15) -0.0001522408 * cos(92*pi ((x^2 + y^2)^0.5)/15) -0.0004139841 * cos(93*pi ((x^2 + y^2)^0.5)/15) +0.0002362457 * cos(94*pi ((x^2 + y^2)^0.5)/15) +0.0003040746 * cos(95*pi ((x^2 + y^2)^0.5)/15) -0.0000045290 * cos(96*pi ((x^2 + y^2)^0.5)/15) +0.0002917901 * cos(97*pi ((x^2 + y^2)^0.5)/15) -0.0000788045 * cos(98*pi ((x^2 + y^2)^0.5)/15) -0.0004671388 * cos(99*pi ((x^2 + y^2)^0.5)/15) +0.0000016866 * cos(100*pi ((x^2 + y^2)^0.5)/15) -0.0000512961 * cos(101*pi ((x^2 + y^2)^0.5)/15) -0.0000505378 * cos(102*pi ((x^2 + y^2)^0.5)/15) +0.0004639663 * cos(103*pi ((x^2 + y^2)^0.5)/15) +0.0001272760 * cos(104*pi ((x^2 + y^2)^0.5)/15) -0.0001777319 * cos(105*pi ((x^2 + y^2)^0.5)/15) +0.0000492601 * cos(106*pi ((x^2 + y^2)^0.5)/15) -0.0003089496 * cos(107*pi ((x^2 + y^2)^0.5)/15) -0.0002682165 * cos(108*pi ((x^2 + y^2)^0.5)/15) +0.0002812331 * cos(109*pi ((x^2 + y^2)^0.5)/15) +0.0000896602 * cos(110*pi ((x^2 + y^2)^0.5)/15) +0.0001053005 * cos(111*pi ((x^2 + y^2)^0.5)/15) +0.0003052815 * cos(112*pi ((x^2 + y^2)^0.5)/15) -0.0002303518 * cos(113*pi ((x^2 + y^2)^0.5)/15) -0.0002800644 * cos(114*pi ((x^2 + y^2)^0.5)/15) +0.0000257274 * cos(115*pi ((x^2 + y^2)^0.5)/15) -0.0001952265 * cos(116*pi ((x^2 + y^2)^0.5)/15) +0.0000926724 * cos(117*pi ((x^2 + y^2)^0.5)/15) +0.0004034548 * cos(118*pi ((x^2 + y^2)^0.5)/15) -0.0000217780 * cos(119*pi ((x^2 + y^2)^0.5)/15) -0.0000091617 * cos(120*pi ((x^2 + y^2)^0.5)/15) +0.0000178157 * cos(121*pi ((x^2 + y^2)^0.5)/15) -0.0003862133 * cos(122*pi ((x^2 + y^2)^0.5)/15) -0.0000861374 * cos(123*pi ((x^2 + y^2)^0.5)/15) +0.0001978360 * cos(124*pi ((x^2 + y^2)^0.5)/15) -0.0000164900 * cos(125*pi ((x^2 + y^2)^0.5)/15) +0.0002435923 * cos(126*pi ((x^2 + y^2)^0.5)/15) +0.0002004370 * cos(127*pi ((x^2 + y^2)^0.5)/15) -0.0002759898 * cos(128*pi ((x^2 + y^2)^0.5)/15) -0.0000997874 * cos(129*pi ((x^2 + y^2)^0.5)/15) -0.0000649028 * cos(130*pi ((x^2 + y^2)^0.5)/15) -0.0002241546 * cos(131*pi ((x^2 + y^2)^0.5)/15) +0.0002224294 * cos(132*pi ((x^2 + y^2)^0.5)/15) +0.0002556206 * cos(133*pi ((x^2 + y^2)^0.5)/15) -0.0000471151 * cos(134*pi ((x^2 + y^2)^0.5)/15) +0.0001235473 * cos(135*pi ((x^2 + y^2)^0.5)/15) -0.0000978288 * cos(136*pi ((x^2 + y^2)^0.5)/15) -0.0003498714 * cos(137*pi ((x^2 + y^2)^0.5)/15) +0.0000416662 * cos(138*pi ((x^2 + y^2)^0.5)/15) +0.0000532274 * cos(139*pi ((x^2 + y^2)^0.5)/15) +0.0003218771 * cos(141*pi ((x^2 + y^2)^0.5)/15) +0.0000516360 * cos(142*pi ((x^2 + y^2)^0.5)/15) -0.0002106403 * cos(143*pi ((x^2 + y^2)^0.5)/15) -0.0000019348 * cos(144*pi ((x^2 + y^2)^0.5)/15) -0.0001882758 * cos(145*pi ((x^2 + y^2)^0.5)/15) -0.0001471365 * cos(146*pi ((x^2 + y^2)^0.5)/15) +0.0002686063 * cos(147*pi ((x^2 + y^2)^0.5)/15) +0.0001011041 * cos(148*pi ((x^2 + y^2)^0.5)/15) +0.0000286562 * cos(149*pi ((x^2 + y^2)^0.5)/15) +0.0001618797 * cos(150*pi ((x^2 + y^2)^0.5)/15) -0.0002121191 * cos(151*pi ((x^2 + y^2)^0.5)/15) -0.0002304757 * cos(152*pi ((x^2 + y^2)^0.5)/15) +0.0000680609 * cos(153*pi ((x^2 + y^2)^0.5)/15) -0.0000694381 * cos(154*pi ((x^2 + y^2)^0.5)/15) +0.0000968474 * cos(155*pi ((x^2 + y^2)^0.5)/15) +0.0003022207 * cos(156*pi ((x^2 + y^2)^0.5)/15) -0.0000602696 * cos(157*pi ((x^2 + y^2)^0.5)/15) -0.0000852624 * cos(158*pi ((x^2 + y^2)^0.5)/15) -0.0000094535 * cos(159*pi ((x^2 + y^2)^0.5)/15) -0.0002660401 * cos(160*pi ((x^2 + y^2)^0.5)/15) -0.0000229197 * cos(161*pi ((x^2 + y^2)^0.5)/15) +0.0002176099 * cos(162*pi ((x^2 + y^2)^0.5)/15) +0.0000102809 * cos(163*pi ((x^2 + y^2)^0.5)/15) +0.0001400070 * cos(164*pi ((x^2 + y^2)^0.5)/15) +0.0001047520 * cos(165*pi ((x^2 + y^2)^0.5)/15) -0.0002589248 * cos(166*pi ((x^2 + y^2)^0.5)/15) -0.0000959118 * cos(167*pi ((x^2 + y^2)^0.5)/15) +0.0000037938 * cos(168*pi ((x^2 + y^2)^0.5)/15) -0.0001132747 * cos(169*pi ((x^2 + y^2)^0.5)/15) +0.0001992868 * cos(170*pi ((x^2 + y^2)^0.5)/15) +0.0002045709 * cos(171*pi ((x^2 + y^2)^0.5)/15) -0.0000874653 * cos(172*pi ((x^2 + y^2)^0.5)/15) +0.0000281296 * cos(173*pi ((x^2 + y^2)^0.5)/15) -0.0000907685 * cos(174*pi ((x^2 + y^2)^0.5)/15) -0.0002588705 * cos(175*pi ((x^2 + y^2)^0.5)/15) +0.0000768935 * cos(176*pi ((x^2 + y^2)^0.5)/15) +0.0001080570 * cos(177*pi ((x^2 + y^2)^0.5)/15) +0.0000108594 * cos(178*pi ((x^2 + y^2)^0.5)/15) +0.0002167408 * cos(179*pi ((x^2 + y^2)^0.5)/15) -0.0002193720 * cos(181*pi ((x^2 + y^2)^0.5)/15) -0.0000113781 * cos(182*pi ((x^2 + y^2)^0.5)/15) -0.0000974728 * cos(183*pi ((x^2 + y^2)^0.5)/15) -0.0000708472 * cos(184*pi ((x^2 + y^2)^0.5)/15) +0.0002464995 * cos(185*pi ((x^2 + y^2)^0.5)/15) +0.0000863292 * cos(186*pi ((x^2 + y^2)^0.5)/15) -0.0000327791 * cos(187*pi ((x^2 + y^2)^0.5)/15) +0.0000753335 * cos(188*pi ((x^2 + y^2)^0.5)/15) -0.0001838632 * cos(189*pi ((x^2 + y^2)^0.5)/15) -0.0001785240 * cos(190*pi ((x^2 + y^2)^0.5)/15) +0.0001049814 * cos(191*pi ((x^2 + y^2)^0.5)/15) +0.0000028872 * cos(192*pi ((x^2 + y^2)^0.5)/15) +0.0000807121 * cos(193*pi ((x^2 + y^2)^0.5)/15) +0.0002190238 * cos(194*pi ((x^2 + y^2)^0.5)/15) -0.0000911722 * cos(195*pi ((x^2 + y^2)^0.5)/15) -0.0001230904 * cos(196*pi ((x^2 + y^2)^0.5)/15) -0.0000069827 * cos(197*pi ((x^2 + y^2)^0.5)/15) -0.0001726112 * cos(198*pi ((x^2 + y^2)^0.5)/15) +0.0000201092 * cos(199*pi ((x^2 + y^2)^0.5)/15) +0.0002165177 * cos(200*pi ((x^2 + y^2)^0.5)/15) +0.0000073771 * cos(201*pi ((x^2 + y^2)^0.5)/15) +0.0000597288 * cos(202*pi ((x^2 + y^2)^0.5)/15) +0.0000442821 * cos(203*pi ((x^2 + y^2)^0.5)/15) -0.0002315725 * cos(204*pi ((x^2 + y^2)^0.5)/15) -0.0000737116 * cos(205*pi ((x^2 + y^2)^0.5)/15) +0.0000583295 * cos(206*pi ((x^2 + y^2)^0.5)/15) -0.0000462483 * cos(207*pi ((x^2 + y^2)^0.5)/15) +0.0001662799 * cos(208*pi ((x^2 + y^2)^0.5)/15) +0.0001526204 * cos(209*pi ((x^2 + y^2)^0.5)/15) -0.0001199887 * cos(210*pi ((x^2 + y^2)^0.5)/15) -0.0000255062 * cos(211*pi ((x^2 + y^2)^0.5)/15) -0.0000675704 * cos(212*pi ((x^2 + y^2)^0.5)/15) -0.0001822471 * cos(213*pi ((x^2 + y^2)^0.5)/15) +0.0001025705 * cos(214*pi ((x^2 + y^2)^0.5)/15) +0.0001317582 * cos(215*pi ((x^2 + y^2)^0.5)/15) +0.0001331087 * cos(217*pi ((x^2 + y^2)^0.5)/15) -0.0000348622 * cos(218*pi ((x^2 + y^2)^0.5)/15) -0.0002097141 * cos(219*pi ((x^2 + y^2)^0.5)/15) -0.0000265600 * cos(221*pi ((x^2 + y^2)^0.5)/15) -0.0000240169 * cos(222*pi ((x^2 + y^2)^0.5)/15) +0.0002143308 * cos(223*pi ((x^2 + y^2)^0.5)/15) +0.0000591909 * cos(224*pi ((x^2 + y^2)^0.5)/15) -0.0000802745 * cos(225*pi ((x^2 + y^2)^0.5)/15) +0.0000245300 * cos(226*pi ((x^2 + y^2)^0.5)/15) -0.0001467711 * cos(227*pi ((x^2 + y^2)^0.5)/15) -0.0001274664 * cos(228*pi ((x^2 + y^2)^0.5)/15) +0.0001321751 * cos(229*pi ((x^2 + y^2)^0.5)/15) +0.0000410904 * cos(230*pi ((x^2 + y^2)^0.5)/15) +0.0000520487 * cos(231*pi ((x^2 + y^2)^0.5)/15) +0.0001485969 * cos(232*pi ((x^2 + y^2)^0.5)/15) -0.0001109564 * cos(233*pi ((x^2 + y^2)^0.5)/15) -0.0001349468 * cos(234*pi ((x^2 + y^2)^0.5)/15) +0.0000115306 * cos(235*pi ((x^2 + y^2)^0.5)/15) -0.0000979633 * cos(236*pi ((x^2 + y^2)^0.5)/15) +0.0000454274 * cos(237*pi ((x^2 + y^2)^0.5)/15) +0.0001994163 * cos(238*pi ((x^2 + y^2)^0.5)/15) -0.0000103747 * cos(239*pi ((x^2 + y^2)^0.5)/15) -0.0000022904 * cos(240*pi ((x^2 + y^2)^0.5)/15) +0.0000093845 * cos(241*pi ((x^2 + y^2)^0.5)/15) -0.0001951116 * cos(242*pi ((x^2 + y^2)^0.5)/15) -0.0000437986 * cos(243*pi ((x^2 + y^2)^0.5)/15) +0.0000986176 * cos(244*pi ((x^2 + y^2)^0.5)/15) -0.0000092343 * cos(245*pi ((x^2 + y^2)^0.5)/15) +0.0001258659 * cos(246*pi ((x^2 + y^2)^0.5)/15) +0.0001035169 * cos(247*pi ((x^2 + y^2)^0.5)/15) -0.0001413062 * cos(248*pi ((x^2 + y^2)^0.5)/15) -0.0000506517 * cos(249*pi ((x^2 + y^2)^0.5)/15) -0.0000349731 * cos(250*pi ((x^2 + y^2)^0.5)/15) -0.0001180478 * cos(251*pi ((x^2 + y^2)^0.5)/15) +0.0001161148 * cos(252*pi ((x^2 + y^2)^0.5)/15) +0.0001335414 * cos(253*pi ((x^2 + y^2)^0.5)/15) -0.0000239544 * cos(254*pi ((x^2 + y^2)^0.5)/15) +0.0000669925 * cos(255*pi ((x^2 + y^2)^0.5)/15) -0.0000519218 * cos(256*pi ((x^2 + y^2)^0.5)/15) -0.0001862869 * cos(257*pi ((x^2 + y^2)^0.5)/15) +0.0000218075 * cos(258*pi ((x^2 + y^2)^0.5)/15) +0.0000268725 * cos(259*pi ((x^2 + y^2)^0.5)/15) +0.0001744012 * cos(261*pi ((x^2 + y^2)^0.5)/15) +0.0000282761 * cos(262*pi ((x^2 + y^2)^0.5)/15) -0.0001132092 * cos(263*pi ((x^2 + y^2)^0.5)/15) -0.0001040330 * cos(265*pi ((x^2 + y^2)^0.5)/15) -0.0000812174 * cos(266*pi ((x^2 + y^2)^0.5)/15) +0.0001471906 * cos(267*pi ((x^2 + y^2)^0.5)/15) +0.0000551847 * cos(268*pi ((x^2 + y^2)^0.5)/15) +0.0000169612 * cos(269*pi ((x^2 + y^2)^0.5)/15) +0.0000907822 * cos(270*pi ((x^2 + y^2)^0.5)/15) -0.0001180412 * cos(271*pi ((x^2 + y^2)^0.5)/15) -0.0001283336 * cos(272*pi ((x^2 + y^2)^0.5)/15) +0.0000373368 * cos(273*pi ((x^2 + y^2)^0.5)/15) -0.0000402108 * cos(274*pi ((x^2 + y^2)^0.5)/15) +0.0000546606 * cos(275*pi ((x^2 + y^2)^0.5)/15) +0.0001708595 * cos(276*pi ((x^2 + y^2)^0.5)/15) -0.0000337231 * cos(277*pi ((x^2 + y^2)^0.5)/15) -0.0000472331 * cos(278*pi ((x^2 + y^2)^0.5)/15) -0.0000053642 * cos(279*pi ((x^2 + y^2)^0.5)/15) -0.0001526208 * cos(280*pi ((x^2 + y^2)^0.5)/15) -0.0000133855 * cos(281*pi ((x^2 + y^2)^0.5)/15) +0.0001240854 * cos(282*pi ((x^2 + y^2)^0.5)/15) +0.0000056759 * cos(283*pi ((x^2 + y^2)^0.5)/15) +0.0000817837 * cos(284*pi ((x^2 + y^2)^0.5)/15) +0.0000610128 * cos(285*pi ((x^2 + y^2)^0.5)/15) -0.0001498502 * cos(286*pi ((x^2 + y^2)^0.5)/15) -0.0000554629 * cos(287*pi ((x^2 + y^2)^0.5)/15) +0.0000012892 * cos(288*pi ((x^2 + y^2)^0.5)/15) -0.0000669066 * cos(289*pi ((x^2 + y^2)^0.5)/15) +0.0001168187 * cos(290*pi ((x^2 + y^2)^0.5)/15) +0.0001200237 * cos(291*pi ((x^2 + y^2)^0.5)/15) -0.0000508653 * cos(292*pi ((x^2 + y^2)^0.5)/15) +0.0000175233 * cos(293*pi ((x^2 + y^2)^0.5)/15) -0.0000539010 * cos(294*pi ((x^2 + y^2)^0.5)/15) -0.0001537495 * cos(295*pi ((x^2 + y^2)^0.5)/15) +0.0000453675 * cos(296*pi ((x^2 + y^2)^0.5)/15) +0.0000634843 * cos(297*pi ((x^2 + y^2)^0.5)/15) +0.0000065938 * cos(298*pi ((x^2 + y^2)^0.5)/15) +0.0001303344 * cos(299*pi ((x^2 + y^2)^0.5)/15)"
    ],
    [red, blue],
    True
)
bellows_fgrade.set_child(bellows1)

# Translate into position:
bellows_fgrade = pv.Translate(x+mainD/2, y+mainD/2, 0, bellows_fgrade)


# -- Caps --
cap1_mesh = pv.Mesh(
    STL_Location + "/variableNumberBellowsStack_ASSEMBLY - CloseCap-1.STL",red)
cap1fgrade = pv.FGrade(["0.95", "0.05"], [blue, red], True )
cap1fgrade.set_child(cap1_mesh)

cap2_mesh = pv.Mesh(
    STL_Location+"/variableNumberBellowsStack_ASSEMBLY - domeCap-1.STL",red)
cap2fgrade =  pv.FGrade(["0.95", "0.05"], [blue, red], True )
cap2fgrade.set_child(cap2_mesh)
cap2_mesh = cap2fgrade

cap2_mesh = pv.Translate(0,0,numStacks*mainHeight+capHeight,cap2_mesh)

# -- Fluid-Solid Support Barrier --
supportBarrier1_mesh = pv.Mesh(
    STL_Location + "/variableNumberBellowsStack_ASSEMBLY - Variable_SupportBundary-1.STL",green
)

# -- Baffles and Fluid --
fluidNoHoles1_mesh = pv.Mesh(
    STL_Location + "/variableNumberBellowsStack_ASSEMBLY - Variable_Fluid-2.STL", liquid_mat
)
fluidAir_fgrade = pv.FGrade([str(fluidPercent),str(1-fluidPercent)],[liquid_mat,yellow],True)

if includeBaffles == True:
    fluidHoles1_mesh = pv.Mesh(
        STL_Location + "/variableNumberBellowsStack_ASSEMBLY - Variable_Fluid-1.STL", liquid_mat
    )
    baffles = pv.Difference(fluidNoHoles1_mesh, fluidHoles1_mesh)
    bafflesFgrade = pv.FGrade(['1'], [green], True)
    bafflesFgrade.set_child(baffles)
    fluidAir_fgrade.set_child(fluidHoles1_mesh)
else:
    fluidAir_fgrade.set_child(fluidNoHoles1_mesh)


#--------------------------------------------------------
#-- Repeating each Bellows Assmbly for N Bellows Stack --
#--------------------------------------------------------
repeatUnion = pv.Union()
repeatUnion.add_child(bellows_fgrade)
repeatUnion.add_child(supportBarrier1_mesh)
repeatUnion.add_child(fluidAir_fgrade)

if includeBaffles == True:
    repeatUnion.add_child(bafflesFgrade)

# Union node for the entire stack of baffles excluding caps
fullStackUnion = pv.Union()
fullStackUnion.add_child(repeatUnion)

for i in range(numStacks-1):
    tempBellowsMesh = repeatUnion
    tempBellowsMesh = pv.Translate(0,0,mainHeight*(i+1),tempBellowsMesh)
    fullStackUnion.add_child(tempBellowsMesh)

#--------------------------------------
#-- Union of all Meshes to Root Node --
#--------------------------------------
root.add_child(fullStackUnion)
root.add_child(cap1fgrade)
root.add_child(cap2_mesh)

#-- Section View --
#tempRect = pv.RectPrism(pv.Vec3(x+mainD/2,y+mainD/2,0),pv.Vec3(mainD,mainD,8),red)
#root = pv.Difference(root,tempRect)